{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Menu - Little Lemon</title>
    <meta name="description" content="View our menu" />
    <meta
      name="author"
      content="Based in Chicago, Illinois, Little Lemon is a family owned Mediterranean restaurant, focused on traditional recipes served with a modern twist."
    />

    <!-- Load favicon -->
    <link
      rel="shortcut icon"
      type="image/png"
      href="{% static 'img/favicon.ico' %}"
    />

    <!-- Include your CSS files here -->
    <link
      rel="preload"
      as="style"
      href="{% static 'css/style.css' %}"
      onload="this.rel = 'stylesheet'"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Karla&family=Markazi+Text:wght@500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <img src="{% static 'img/logo.png' %}" />
    </header>
    <nav>
      <ul>
        <li><a href="{% url 'home' %}">Home</a></li>
        <li><a href="{% url 'about' %}">About</a></li>
        <li><a href="{% url 'menu' %}">Menu</a></li>
        <li><a href="{% url 'book' %}">Book</a></li>
      </ul>
    </nav>
    <section>
      <article>
        <h2>Our Menu</h2>
        <p>
          Our menu consists of 12-15 seasonal items based on Italian, Greek, and Turkish culture.
        </p>
        <div id="menu" style="margin-top: 2rem;">
          <p>Loading menu items...</p>
        </div>
      </article>
    </section>
    <footer>
      <article>
        <img src="{% static 'img/logo_footer.png' %}" />
      </article>
      <article>
        <p>Copyright Little Lemon</p>
      </article>
    </footer>

    <script>
      // Fetch menu items from API
      async function loadMenuItems() {
        const menuContainer = document.getElementById('menu');
        
        try {
          const response = await fetch('/api/menu/');
          
          if (!response.ok) {
            throw new Error('Failed to fetch menu items');
          }
          
          const menuItems = await response.json();
          
          if (menuItems.length === 0) {
            menuContainer.innerHTML = '<p>No menu items available at this time.</p>';
            return;
          }
          
          let html = '<ul style="list-style: none; padding: 0;">';
          menuItems.forEach(item => {
            html += `
              <li style="border: 1px solid #EDEFEE; padding: 1rem; margin-bottom: 1rem; border-radius: 5px;">
                <h3 style="margin-top: 0; color: #495E57;">${item.title}</h3>
                <p style="font-size: 1.1rem; margin: 0.5rem 0;">
                  <span class="menu-price" style="font-weight: bold; color: #EE9972; font-size: 1.25rem;">$${parseFloat(item.price).toFixed(2)}</span>
                </p>
                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">
                  ${item.inventory > 0 ? `Available (${item.inventory} in stock)` : 'Currently unavailable'}
                </p>
              </li>
            `;
          });
          html += '</ul>';
          
          menuContainer.innerHTML = html;
        } catch (error) {
          console.error('Error loading menu items:', error);
          menuContainer.innerHTML = '<p style="color: red;">Error loading menu items. Please try again later.</p>';
        }
      }
      
      // Load menu items when page loads
      document.addEventListener('DOMContentLoaded', loadMenuItems);
    </script>
  </body>
</html>

